---
title: "На точак"
output:
  html_document:
    df_print: paged
---
```{r}
library(tidyverse)
```

```{r}
#get the data
accidents <- as_tibble(read_csv("mvr-data.csv"))
```

```{r}
#keep the traffic accidents
traffacc <- accidents %>% 
  #separate Date of event; having months as observations might be useful.
  separate(DateOfEvent, c("Day", "Month", "Year"), sep = "\\.", remove = FALSE) %>% 
  #filter so we keep just the traffic accidents
  filter(Event == "сообраќајна незгода")
```

```{r}
#On what type of roads traffic accidents happen and is it a crossroad?
with(traffacc, table(TypeOfRoad, Crossroad))

traffacc %>% mutate(Crossroad2=case_when(Crossroad == "да" ~ "Да",
                                         Crossroad == "не" ~ "Не",
                                         is.na(Crossroad) ~ "Нема податок")) %>%
  ggplot(aes(TypeOfRoad)) +
    geom_bar(aes(fill=Crossroad2), width = 0.5) +
    scale_x_discrete(labels=c("Отворен", "Рурален", "Градски")) +
    theme(axis.text.x = element_text(angle=45, vjust=1, hjust=1)) +
    scale_fill_brewer() +
    labs(title="Сообраќајни незгоди на велосипедисти по видови на патишта и крстосници", 
            x = "Видови патишта", y = "Број на сообраќајни незгоди", fill = "Крстосница") 

    

#Which months?
with(traffacc, table(Month, Year))

#plot the age of cyclists and drivers

#Is there a correlation between roads and outcome; months and outcome; age of bycicle rider and outcome?


```





